C4Container
title "WaveTap - Container View"

Person(user, "Client User", "Browser / Dashboard / CLI")

System_Ext(aircraft, "Aircraft", "Broadcasts ADS-B and Voice Signals")

System_Boundary(wt, "WaveTap") {
  Container(sdr_cap, "SDR Capture Service", "Python + pyrtlsdr", "Owns RTL-SDR; streams IQ")
  Container(arb, "Coordinator / Arbiter", "Go/Python", "Serializes tuning; allocates bandwidth window")
  Container(api, "API Gateway", "FastAPI/Express", "REST + WebSocket aggregation")
  Container(ui, "Web UI / Dashboard", "React/Vue", "Tables, maps, streams")
  Container(dec_adsb, "ADS-B Decoder Service", "Python", "Decodes Mode-S / ADS-B messages")
  Container(dec_fm, "FM Decoder Service", "Python", "Demodulates narrowband FM audio")
  Container(dec_atc, "ATC Voice Decoder", "Python", "Optional voice channel decode")
  Container(db, "Persistent Store", "Postgres", "Historical tracks, logs")
}

Rel(aircraft, sdr_cap, "Broadcasts ADS-B and Voice Signals")
Rel(user, ui, "Uses", "HTTPS")
Rel(ui, api, "Calls", "REST")
Rel(api, arb, "Requests tuning", "REST")
Rel(arb, sdr_cap, "Issues tuning commands", "RPC/REST")
Rel(sdr_cap, dec_adsb, "Streams IQ data")
Rel(sdr_cap, dec_fm, "Streams audio frames", "WebSocket")
Rel(dec_adsb, db, "Persists tracks", "SQL/Bulk")
Rel(dec_fm, api, "Streams audio frames", "WebSocket")
